
create deb pkg structure

## 1. Build .NET Application

```
dotnet publish -c Release -r linux-arm64 -p:PublishSingleFile=true --self-contained true -o ./publish
```

## 2. Create debian package structure

```bash
pkg/
├── DEBIAN/
│   ├── control        # Required metadata
│   ├── postinst       # Optional install script
│   ├── prerm          # Optional uninstall script
├── usr/
│   └── local/
│       └── bin/
│           └── MyWeatherApi (app files)
```

```
dpkg-deb --build pkg myweatherapi_1.0.0.deb
```

## 3. Incorporate previous steps into jenkinsfile

Jenkins file explanation
```
pipeline {
    agent {
        docker {
            image 'mcr.microsoft.com/dotnet/sdk:8.0'
            args '-u root:root'  // Run as root to install dpkg-dev
        }
    }
    
    environment {
        DOTNET_VERSION = '8.0'
        PACKAGE_NAME = 'myweatherapi'
        PACKAGE_VERSION = '1.0.0'
    }
    
    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }
        
        stage('Build .NET Application') {
            steps {
                script {
                    sh '''
                        dotnet restore RaspiSimpleAPI.csproj

                        dotnet publish RaspiSimpleAPI.csproj -c Release -r linux-arm64 --self-contained true -p:PublishSingleFile=true -p:AssemblyName=MyWeatherApi -o ./publish
                        
                        grep -q "AssemblyName" *.csproj || echo "Warning: AssemblyName not specified in project file"
                    '''
                }
            }
        }
        
        stage('Create Debian Package') {
            steps {
                script {
                    sh '''
                        apt-get update
                        apt-get install -y dpkg-dev
                        
                        chmod +x ./create-deb-package.sh
                        ./create-deb-package.sh
                    '''
                }
            }
        }

    }
    
    post {
        success {
            archiveArtifacts artifacts: '*.deb', followSymlinks: false
        }
        failure {
            echo 'Pipeline failed! Check the logs for details.'
        }
        cleanup {
            cleanWs()
        }
    }
}
```

## 4. Push changes and configure jenkins

push the code
create folder, create new item
choose 












